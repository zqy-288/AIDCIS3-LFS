# 报告输出界面使用说明

## 概述

第四级【报告输出】界面是管孔检测系统的报告生成与管理模块，用于生成包含工件信息、检测数据汇总、合格率分析、不合格孔位详细数据、人工复检记录和最终判定的综合质量检测报告。

## 界面功能

### 1. 工件选择
- 在左侧配置面板的"工件选择"区域，从下拉框中选择要生成报告的工件
- 系统会自动扫描Data目录下的可用工件数据

### 2. 报告类型配置
支持四种报告类型：
- **综合报告**：包含所有检测信息的完整报告
- **工件汇总报告**：重点关注工件基本信息和整体质量状况
- **质量分析报告**：专注于质量数据分析和统计
- **缺陷分析报告**：重点分析缺陷数据和异常情况

### 3. 输出格式
支持多种输出格式：
- **PDF**：专业的报告格式，适合打印和存档
- **HTML**：网页格式，便于在线查看和分享
- **Excel**：表格格式，便于数据分析
- **Word**：文档格式，便于编辑和修改

### 4. 报告内容选项
可以灵活选择报告包含的内容：
- ✅ **包含工件信息**：工件ID、名称、类型、材料等基本信息
- ✅ **包含质量汇总**：总孔位数、合格率、统计数据等
- ✅ **包含合格孔位**：合格孔位的汇总信息
- ✅ **包含不合格孔位**：不合格孔位的详细分析
- ✅ **包含缺陷分析**：缺陷类型、数量、分布等分析
- ✅ **包含人工复检记录**：人工复检的详细记录
- ✅ **包含图表**：各种统计图表和可视化内容
- ✅ **包含内窥镜图像**：相关的内窥镜检测图像

## 使用步骤

### 步骤1：选择工件
1. 在"工件选择"下拉框中选择要生成报告的工件
2. 系统会自动加载该工件的数据并在右侧显示预览

### 步骤2：配置报告
1. 选择报告类型（推荐使用"综合报告"）
2. 选择输出格式（推荐使用"PDF"）
3. 根据需要勾选或取消勾选报告内容选项

### 步骤3：预览数据
1. 在右侧"数据预览"标签页中查看工件的数据汇总
2. 检查孔位数据表格，确认数据完整性
3. 查看质量统计信息

### 步骤4：生成报告
1. 点击"预览报告"按钮可以预览报告内容（功能待实现）
2. 点击"生成报告"按钮开始生成报告
3. 等待进度条完成，系统会显示报告生成结果

### 步骤5：管理报告
1. 在"报告管理"标签页中查看历史生成的报告
2. 可以重新打开、删除或分享已生成的报告

## 报告内容说明

### 1. 工件信息
- 工件ID、名称、类型、材料
- 总孔位数、项目描述
- 创建时间等基本信息

### 2. 质量汇总
- 总孔位数、合格孔位数、不合格孔位数
- 整体合格率百分比
- 有缺陷孔位数量
- 人工复检数量
- 完成率统计

### 3. 合格孔位汇总
- 合格孔位列表
- 各孔位的合格率
- 测量次数统计

### 4. 不合格孔位详情
对于每个不合格孔位，报告包含：
- 孔位ID和位置坐标
- 目标直径和公差范围
- 实际测量数据
- 合格率和偏差统计
- 包络图（如果包含图表选项）
- 相关的内窥镜图像

### 5. 人工复检记录
- 复检员信息
- 原始测量值和复检值
- 复检原因和时间
- 最终判定结果
- 复检备注

### 6. 缺陷分析
- 缺陷类型统计
- 缺陷分布分析
- 缺陷图像和标注
- 缺陷严重程度评估

## 快速访问

### 从主检测视图跳转
1. 在主检测视图中选择任意孔位
2. 点击右侧操作面板中的"生成报告"按钮
3. 系统会自动跳转到报告输出界面并加载相应的工件数据

### 直接访问
1. 点击主窗口顶部的"报告输出"标签页
2. 手动选择要生成报告的工件

## 技术特性

### 数据收集
- 自动扫描Data目录下的CSV测量数据
- 支持多种文件编码格式（UTF-8、GBK、GB2312等）
- 智能解析测量数据和质量统计

### 报告生成
- 多线程后台生成，不阻塞界面操作
- 实时进度显示和状态更新
- 错误处理和异常恢复

### 文件管理
- 自动创建reports目录结构
- 按工件ID组织报告文件
- 支持文件大小统计和历史记录

## 注意事项

1. **数据完整性**：确保Data目录下有完整的测量数据文件
2. **文件权限**：确保程序有权限在reports目录下创建文件
3. **磁盘空间**：PDF报告可能较大，确保有足够的磁盘空间
4. **依赖库**：PDF生成需要reportlab库，如未安装会回退到文本格式

## 故障排除

### 问题1：无法找到工件数据
- 检查Data目录结构是否正确
- 确认工件目录下有CCIDM子目录和CSV文件

### 问题2：报告生成失败
- 检查reports目录是否可写
- 查看错误信息，可能是编码或文件格式问题

### 问题3：数据显示为空
- 检查CSV文件编码格式
- 确认CSV文件包含有效的测量数据

### 问题4：PDF生成失败
- 安装reportlab库：`pip install reportlab`
- 或使用其他格式如HTML或文本格式

## 更新日志

### v1.0.0 (2025-07-12)
- 初始版本发布
- 支持基本的报告生成功能
- 实现PDF和文本格式输出
- 集成到主窗口标签页系统
