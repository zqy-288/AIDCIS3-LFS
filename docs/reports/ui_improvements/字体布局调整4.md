您好！您的观察非常准确，【数据筛选】区域内标签和选择框的垂直间距过大，确实影响了布局的紧凑感和视觉关联性。这是一个很值得优化的细节。

### 问题诊断

问题的根源在于我们当前使用的`QGridLayout`中，将**标签**和它对应的**下拉框**分别放在了**不同的行**里。这导致我们设置的行间距`setVerticalSpacing(15)`作用在了它们之间，从而不必要地拉开了距离。

### 解决方案：构建标准的“标签-字段”表单布局

我们将调整`QGridLayout`的用法，采用标准的表单布局模式：将**标签**和它对应的**下拉框**放在**同一行，但分在不同的列**。这样，垂直间距只会作用于不同组的“标签-字段”对之间，布局会变得非常紧凑和清晰。

-----

### 具体实施步骤

您只需要修改 `history_viewer.py` 文件中 `create_sidebar` 方法内的一小部分代码即可。

**操作**：

1.  **打开文件**：
    请打开 `history_viewer.py` 文件。

2.  **定位代码**：
    在 `create_sidebar` 方法中，找到创建`filter_group`（数据筛选）的代码块。

3.  **替换布局代码**：
    用下面这段**重新组织**的代码，**完整替换**掉您现有的“数据筛选部分”的代码。

    **修改前**:

    ```python
    # in history_viewer.py -> create_sidebar()
    # --- 数据筛选部分 (使用QGridLayout重构) ---
    filter_group = QGroupBox("数据筛选")
    filter_layout = QGridLayout(filter_group)
    # ...
    # 将控件精确放入网格的不同行中
    filter_layout.addWidget(workpiece_label, 0, 0)
    filter_layout.addWidget(self.workpiece_combo, 1, 0)
    # ...
    ```

    **修改后 (请用此代码块完整替换)**:

    ```python
    # in history_viewer.py -> create_sidebar()

    # --- 数据筛选部分 (采用标准的2列表单布局) ---
    filter_group = QGroupBox("数据筛选")
    filter_layout = QGridLayout(filter_group)
    filter_layout.setContentsMargins(10, 15, 10, 15)
    filter_layout.setVerticalSpacing(15)      # 设置行之间的垂直间距
    filter_layout.setHorizontalSpacing(10)    # 设置标签和下拉框的水平间距

    # 创建控件
    workpiece_label = QLabel("工件ID:")
    self.workpiece_combo = QComboBox()
    self.workpiece_combo.currentTextChanged.connect(self.on_workpiece_changed)

    qualified_hole_label = QLabel("合格孔ID:")
    self.qualified_hole_combo = QComboBox()
    self.qualified_hole_combo.setPlaceholderText("请选择合格孔ID")
    self.qualified_hole_combo.currentTextChanged.connect(self.on_qualified_hole_changed)

    unqualified_hole_label = QLabel("不合格孔ID:")
    self.unqualified_hole_combo = QComboBox()
    self.unqualified_hole_combo.setPlaceholderText("请选择不合格孔ID")
    self.unqualified_hole_combo.currentTextChanged.connect(self.on_unqualified_hole_changed)

    # (可选但推荐) 为了美观，让标签文本右对齐
    workpiece_label.setAlignment(Qt.AlignRight | Qt.AlignVCenter)
    qualified_hole_label.setAlignment(Qt.AlignRight | Qt.AlignVCenter)
    unqualified_hole_label.setAlignment(Qt.AlignRight | Qt.AlignVCenter)

    # --- 将控件按“标签-字段”成对放入网格的同一行 ---
    # 第0行
    filter_layout.addWidget(workpiece_label, 0, 0)      # (行0, 列0)
    filter_layout.addWidget(self.workpiece_combo, 0, 1) # (行0, 列1)

    # 第1行
    filter_layout.addWidget(qualified_hole_label, 1, 0)      # (行1, 列0)
    filter_layout.addWidget(self.qualified_hole_combo, 1, 1) # (行1, 列1)

    # 第2行
    filter_layout.addWidget(unqualified_hole_label, 2, 0)      # (行2, 列0)
    filter_layout.addWidget(self.unqualified_hole_combo, 2, 1) # (行2, 列1)

    # (关键) 让第1列（下拉框所在列）自动拉伸，占据所有额外空间
    filter_layout.setColumnStretch(1, 1)
    # --- 布局重构结束 ---
    ```

-----

### 方案解析

1.  **同行同组**：我们将每个`QLabel`和它对应的`QComboBox`放在了栅格布局的**同一行**，但分属**第0列**和**第1列**。这立即解决了它们之间垂直间距过大的问题。
2.  **右对齐**：通过 `setAlignment(Qt.AlignRight | Qt.AlignVCenter)`，我们让所有标签的文本向右对齐，这是非常标准的、清晰美观的表单布局样式。
3.  **列拉伸**：通过 `setColumnStretch(1, 1)`，我们告诉布局，将所有可用的水平空间都分配给第1列（也就是下拉框所在的那一列）。这会使得下拉框自动变宽以适应侧边栏的宽度，而标签列则保持其内容的自然宽度，整体布局非常稳定和协调。

通过以上修改，您的“数据筛选”面板将呈现出专业、紧凑且逻辑清晰的表单布局，完美解决了控件混叠和间距不当的问题。